---
import FlowChart from './FlowChart.astro';
import ComparisonContainer from './ComparisonContainer.astro';
import Table from './Table.astro';
import WorkflowCard from './WorkflowCard.astro';
---

<section id="benefits" class="benefits-section">
  <div class="container">
    <h2 class="edge-title">도입 효과</h2>
    
    <h3 class="section-subtitle">Workflow Comparison</h3>
    <p>EdgeX와 기존 LLM 처리 방식의 워크플로우 흐름을 비교합니다.</p>
    
    <ComparisonContainer leftTitle="LLM Workflow" rightTitle="EdgeX Workflow">
      <div slot="left">
        <p>기존 LLM(Large Language Model) 처리 방식은 중앙 서버에 의존하는 구조로, 지연 시간과 비용이 발생합니다.</p>
        
        <div class="workflow-vertical">
          <div class="workflow-step">
            <div class="step-number">1</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-comment-alt"></i></div>
              <div class="step-content">
                <h4 class="step-title">Text Request</h4>
                <p class="step-description">사용자가 자연어 형태의 텍스트 요청을 생성하여 LLM 시스템에 전송합니다.</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">2</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-cogs"></i></div>
              <div class="step-content">
                <h4 class="step-title">Preprocessing</h4>
                <p class="step-description">입력된 텍스트는 토큰화, 인코딩 등의 전처리 과정을 거쳐 모델이 이해할 수 있는 형태로 변환됩니다.</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">3</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-server"></i></div>
              <div class="step-content">
                <h4 class="step-title">LLM Processing</h4>
                <p class="step-description">클라우드 서버에서 대규모 언어 모델이 요청을 처리하고 적절한 응답을 생성합니다.</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">4</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-robot"></i></div>
              <div class="step-content">
                <h4 class="step-title">Response Generation</h4>
                <p class="step-description">모델의 출력을 기반으로 사용자에게 제공할 최종 응답을 생성합니다.</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">5</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-reply"></i></div>
              <div class="step-content">
                <h4 class="step-title">Return</h4>
                <p class="step-description">생성된 응답이 사용자에게 반환되어 표시됩니다.</p>
              </div>
            </div>
          </div>
        </div>
        
        <div class="flow-stats-grid">
          <div class="flow-stat">
            <div class="stat-icon">
              <i class="fas fa-clock"></i>
            </div>
            <div class="stat-details">
              <div class="stat-title">Processing Time</div>
              <div class="stat-value">2-5초</div>
              <div class="stat-desc">네트워크 상태에 따라 변동</div>
            </div>
          </div>
          
          <div class="flow-stat">
            <div class="stat-icon">
              <i class="fas fa-server"></i>
            </div>
            <div class="stat-details">
              <div class="stat-title">Server Dependency</div>
              <div class="stat-value">100%</div>
              <div class="stat-desc">모든 처리 클라우드 기반</div>
            </div>
          </div>
          
          <div class="flow-stat">
            <div class="stat-icon">
              <i class="fas fa-dollar-sign"></i>
            </div>
            <div class="stat-details">
              <div class="stat-title">Operation Cost</div>
              <div class="stat-value">높음</div>
              <div class="stat-desc">API 호출당 비용 발생</div>
            </div>
          </div>
        </div>
      </div>
      
      <div slot="right">
        <p>EdgeX는 AI 처리를 분산 네트워크로 분배하여 효율적으로 처리하고, 로컬에서 처리 가능한 작업은 즉시 수행합니다.</p>
        
        <div class="workflow-vertical">
          <div class="workflow-step">
            <div class="step-number">1</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-user"></i></div>
              <div class="step-content">
                <h4 class="step-title">User Request</h4>
                <p class="step-description">사용자가 EdgeX 시스템을 통해 자연어 형태의 요청을 생성합니다.</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">2</div>
            <div class="step-card accent">
              <div class="step-icon"><i class="fas fa-microchip"></i></div>
              <div class="step-content">
                <h4 class="step-title">EdgeX Node</h4>
                <p class="step-description">요청이 EdgeX 노드에 도달하여 초기 분석 및 처리 경로를 결정합니다.</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">3</div>
            <div class="step-card accent">
              <div class="step-icon"><i class="fas fa-brain"></i></div>
              <div class="step-content">
                <h4 class="step-title">Processing & Evaluation</h4>
                <p class="step-description">EdgeX 시스템이 요청을 분석하여 로컬 처리 가능 여부를 판단합니다.</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step branch">
            <div class="step-branch-container">
              <div class="branch-line"></div>
              <div class="branch-steps">
                <div class="branch-step">
                  <div class="step-number">4A</div>
                  <div class="step-card">
                    <div class="step-icon"><i class="fas fa-bolt"></i></div>
                    <div class="step-content">
                      <h4 class="step-title">Local Processing</h4>
                      <p class="step-description">간단한 요청이나 자주 처리되는 패턴은 로컬 XR7 엔진에서 빠르게 처리합니다.</p>
                    </div>
                  </div>
                </div>
                
                <div class="branch-step">
                  <div class="step-number">4B</div>
                  <div class="step-card">
                    <div class="step-icon"><i class="fas fa-cloud"></i></div>
                    <div class="step-content">
                      <h4 class="step-title">Cloud Processing</h4>
                      <p class="step-description">복잡한 요청은 분산 네트워크를 통해 클라우드 LLM으로 전달됩니다.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">5</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-comment-dots"></i></div>
              <div class="step-content">
                <h4 class="step-title">Response</h4>
                <p class="step-description">두 처리 경로를 통해 생성된 응답이 사용자에게 일관된 형태로 제공됩니다.</p>
              </div>
            </div>
          </div>
        </div>
        
        <div class="flow-stats-grid">
          <div class="flow-stat highlight">
            <div class="stat-icon">
              <i class="fas fa-tachometer-alt"></i>
            </div>
            <div class="stat-details">
              <div class="stat-title">Processing Time</div>
              <div class="stat-value">0.5-2초</div>
              <div class="stat-desc">60% 이상 개선</div>
            </div>
          </div>
          
          <div class="flow-stat highlight">
            <div class="stat-icon">
              <i class="fas fa-network-wired"></i>
            </div>
            <div class="stat-details">
              <div class="stat-title">Local Processing Rate</div>
              <div class="stat-value">40-70%</div>
              <div class="stat-desc">모델 최적화로 향상</div>
            </div>
          </div>
          
          <div class="flow-stat highlight">
            <div class="stat-icon">
              <i class="fas fa-coins"></i>
            </div>
            <div class="stat-details">
              <div class="stat-title">Revenue Generation</div>
              <div class="stat-value">가능</div>
              <div class="stat-desc">$EX 토큰 보상 발생</div>
            </div>
          </div>
        </div>
      </div>
    </ComparisonContainer>
    
    <h3 class="section-subtitle mt-3">Workflow Comparison Example</h3>
    
    <ComparisonContainer leftTitle="Without EdgeX" rightTitle="With EdgeX">
      <div slot="left">
        <div class="workflow-vertical compact">
          <div class="workflow-step">
            <div class="step-number">1</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-user"></i></div>
              <div class="step-content">
                <h4 class="step-title">User</h4>
                <p class="step-description">사용자가 날씨 정보 요청</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">2</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-cloud"></i></div>
              <div class="step-content">
                <h4 class="step-title">Cloud</h4>
                <p class="step-description">모든 요청이 클라우드 서버로 전송</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">3</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-reply"></i></div>
              <div class="step-content">
                <h4 class="step-title">API Response</h4>
                <p class="step-description">외부 API에서 응답 수신 후 사용자에게 전달</p>
              </div>
            </div>
          </div>
        </div>
        <div class="vs-details">
          <div class="vs-metric">
            <span class="vs-metric-label">Response Time</span>
            <span class="vs-metric-value">3.2초</span>
          </div>
          <div class="vs-metric">
            <span class="vs-metric-label">Cost</span>
            <span class="vs-metric-value">API 호출</span>
          </div>
          <div class="vs-metric">
            <span class="vs-metric-label">Privacy</span>
            <span class="vs-metric-value">낮음</span>
          </div>
        </div>
      </div>
      
      <div slot="right">
        <div class="workflow-vertical compact">
          <div class="workflow-step">
            <div class="step-number">1</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-user"></i></div>
              <div class="step-content">
                <h4 class="step-title">User</h4>
                <p class="step-description">사용자가 날씨 정보 요청</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">2</div>
            <div class="step-card accent">
              <div class="step-icon"><i class="fas fa-microchip"></i></div>
              <div class="step-content">
                <h4 class="step-title">XR7 Evaluation</h4>
                <p class="step-description">EdgeX가 로컬에서 처리 가능한지 판단</p>
              </div>
            </div>
          </div>
          
          <div class="workflow-step">
            <div class="step-number">3</div>
            <div class="step-card">
              <div class="step-icon"><i class="fas fa-reply"></i></div>
              <div class="step-content">
                <h4 class="step-title">API Response</h4>
                <p class="step-description">캐싱된 데이터 또는 최적화된 API 요청으로 응답</p>
              </div>
            </div>
          </div>
        </div>
        <div class="vs-details">
          <div class="vs-metric highlight">
            <span class="vs-metric-label">Response Time</span>
            <span class="vs-metric-value">0.8초</span>
          </div>
          <div class="vs-metric highlight">
            <span class="vs-metric-label">Cost</span>
            <span class="vs-metric-value">없음</span>
          </div>
          <div class="vs-metric highlight">
            <span class="vs-metric-label">Privacy</span>
            <span class="vs-metric-value">높음</span>
          </div>
        </div>
      </div>
    </ComparisonContainer>
    
    <h3 class="section-subtitle mt-3">EdgeX Comparison Table</h3>
    <Table headers={["Feature", "Without EdgeX", "With EdgeX"]}>
      <tr>
        <td><strong>Speed</strong></td>
        <td>Slow (Server Latency)</td>
        <td class="highlight-cell">Fast (Local Processing)</td>
      </tr>
      <tr>
        <td><strong>Cost</strong></td>
        <td>Server Cost Increase</td>
        <td class="highlight-cell">Processing Cost Reduction</td>
      </tr>
      <tr>
        <td><strong>Privacy</strong></td>
        <td>Exposure Risk</td>
        <td class="highlight-cell">Protected by Local Processing</td>
      </tr>
      <tr>
        <td><strong>Reliability</strong></td>
        <td>Server Status Dependent</td>
        <td class="highlight-cell">Local Device-Centered Trust</td>
      </tr>
      <tr>
        <td><strong>Profitability</strong></td>
        <td>Cost Incurred</td>
        <td class="highlight-cell">$EX Token Rewards</td>
      </tr>
    </Table>
  </div>
</section>

<style>
  .benefits-section {
    background: var(--dark-bg);
    position: relative;
  }
  
  .mt-3 {
    margin-top: 3rem;
  }
  
  /* 수직 워크플로우 스타일 */
  .workflow-vertical {
    display: flex;
    flex-direction: column;
    gap: 0;
    max-width: 750px;
    margin: 2rem auto;
    position: relative;
  }
  
  .workflow-vertical.compact {
    max-width: 450px;
  }
  
  .workflow-step {
    display: flex;
    position: relative;
    z-index: 1;
  }
  
  .workflow-step:not(:last-child)::after {
    content: '';
    position: absolute;
    top: 40px;
    left: 20px;
    width: 2px;
    height: calc(100% + 10px);
    background-color: var(--primary);
    opacity: 0.3;
    z-index: 0;
  }
  
  .step-number {
    width: 40px;
    height: 40px;
    min-width: 40px;
    border-radius: 50%;
    background: rgba(0, 85, 255, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    color: var(--primary);
    margin-right: 1rem;
    z-index: 2;
  }
  
  .step-card {
    flex: 1;
    background: var(--dark-surface);
    border-radius: 10px;
    padding: 1.2rem;
    margin-bottom: 1.5rem;
    position: relative;
    display: flex;
    gap: 1rem;
    transition: all 0.3s ease;
  }
  
  .step-card:hover {
    transform: translateX(5px);
  }
  
  .step-card.accent {
    background: linear-gradient(145deg, var(--dark-surface), rgba(0, 85, 255, 0.1));
    border-left: 3px solid var(--primary);
  }
  
  .step-icon {
    width: 40px;
    height: 40px;
    min-width: 40px;
    border-radius: 8px;
    background: rgba(0, 85, 255, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    color: var(--primary);
  }
  
  .step-content {
    flex: 1;
  }
  
  .step-title {
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
    color: var(--text-primary);
  }
  
  .step-description {
    font-size: 0.9rem;
    color: var(--text-secondary);
    line-height: 1.5;
  }
  
  /* 분기되는 흐름 처리 */
  .workflow-step.branch {
    display: block;
  }
  
  .step-branch-container {
    position: relative;
    padding-left: 40px;
  }
  
  .branch-line {
    position: absolute;
    left: 20px;
    top: -20px;
    width: 30px;
    height: 40px;
    border-left: 2px solid rgba(0, 85, 255, 0.3);
    border-bottom: 2px solid rgba(0, 85, 255, 0.3);
    border-radius: 0 0 0 10px;
  }
  
  .branch-steps {
    margin-left: 20px;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  
  .branch-step {
    display: flex;
    position: relative;
  }
  
  .branch-step::before {
    content: '';
    position: absolute;
    left: -20px;
    top: 20px;
    width: 20px;
    height: 2px;
    background-color: rgba(0, 85, 255, 0.3);
  }
  
  /* 통계 카드 스타일 */
  .flow-stats-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
    margin-top: 2rem;
  }
  
  .flow-stat {
    background: var(--dark-surface);
    border-radius: 10px;
    padding: 1.5rem;
    display: flex;
    gap: 1rem;
    align-items: center;
    transition: var(--transition-normal);
  }
  
  .flow-stat:hover {
    transform: translateY(-5px);
  }
  
  .flow-stat.highlight {
    background: linear-gradient(145deg, var(--dark-surface), rgba(0, 85, 255, 0.1));
    border-left: 3px solid var(--primary);
  }
  
  .stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: rgba(0, 85, 255, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    color: var(--primary);
  }
  
  .stat-details {
    flex: 1;
  }
  
  .stat-title {
    font-size: 0.9rem;
    color: var(--text-secondary);
    margin-bottom: 0.3rem;
  }
  
  .stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.3rem;
  }
  
  .stat-desc {
    font-size: 0.8rem;
    color: var(--text-secondary);
  }
  
  .vs-details {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-top: 1.5rem;
  }
  
  .vs-metric {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 0.8rem;
    border-radius: 8px;
    background: rgba(0, 0, 0, 0.2);
  }
  
  .vs-metric.highlight {
    background: rgba(0, 85, 255, 0.1);
  }
  
  .vs-metric-label {
    font-size: 0.8rem;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
  }
  
  .vs-metric-value {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-primary);
  }
  
  .highlight-cell {
    color: var(--primary);
    font-weight: 600;
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @media (max-width: 1024px) {
    .workflow-branch-cards {
      grid-template-columns: 1fr;
    }
  }
  
  @media (max-width: 768px) {
    .flow-stats-grid {
      grid-template-columns: 1fr;
    }
    
    .vs-details {
      grid-template-columns: 1fr;
    }
    
    .step-card {
      flex-direction: column;
    }
    
    .step-icon {
      margin-bottom: 0.5rem;
    }
  }
</style>
